<UserControl x:Class="BauphysikToolWPF.UI.Page_TemperatureResults"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:ui="clr-namespace:BauphysikToolWPF.Services.UI"
             xmlns:controls="clr-namespace:BauphysikToolWPF.UI.CustomControls"
             xmlns:vm="clr-namespace:BauphysikToolWPF.UI.ViewModels"
             xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.WPF;assembly=LiveChartsCore.SkiaSharpView.WPF"
             xmlns:application="clr-namespace:BauphysikToolWPF.Services.Application"
             xmlns:converter="clr-namespace:BauphysikToolWPF.Services.UI.Converter"
             mc:Ignorable="d" 
             d:DesignHeight="700"
             d:DesignWidth="1200">

    <UserControl.DataContext>
        <!-- Sets the Data Reference (Source) for 'Binding' in this XAML -->
        <vm:Page_TemperatureResults_VM/>
    </UserControl.DataContext>

    <UserControl.Resources>
        <converter:NumberConverter x:Key="NumberConverter" />
    </UserControl.Resources>

    <!--Main Grid 2x2-->
    <Grid Background="{StaticResource PrimaryLightBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="40" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" MinWidth="320"/>
            <ColumnDefinition Width="360" MaxWidth="360" MinWidth="16"/>
        </Grid.ColumnDefinitions>

        <!--Top -->
        <Border Grid.ColumnSpan="2" Background="{StaticResource PrimaryMediumBrush}">
            <Grid>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                    <Button Style="{StaticResource ButtonMiniTransparent}" Command="{Binding SwitchPageCommand}" CommandParameter="{x:Static application:NavigationPage.Summary}" Tag="{StaticResource ButtonIcon_Prev_B}" Margin="4"/>
                    <Label Content="Zurück"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Ellipse Fill="{Binding SelectedElementColorCode}" Width="16" Height="16" Margin="0,0,8,0"/>
                    <Label Content="{Binding Title}" FontSize="18" FontWeight="Bold" FontStretch="Expanded"/>
                    <Label Content="{Binding SelectedElementConstructionName}" ContentStringFormat="({0})" FontSize="18" FontStyle="Italic" Margin="0,0,8,0"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Label Content="Weiter"/>
                    <Button Style="{StaticResource ButtonMiniTransparent}" Command="{Binding SwitchPageCommand}" CommandParameter="{x:Static application:NavigationPage.GlaserCurve}" Tag="{StaticResource ButtonIcon_Next_B}" Margin="4"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!--Bottom Left-->
        <Grid Grid.Row="1" Grid.Column="0" Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0" Visibility="{Binding ResultsChartVisibility}" BorderBrush="{StaticResource PrimaryBorderBrush}" Background="White" BorderThickness="1" SnapsToDevicePixels="True" ClipToBounds="True" CornerRadius="8">
                <Grid>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="8,0,0,0">
                        <Label Content="Innen" FontWeight="Bold"/>
                        <Line Y2="32" Stroke="LightGray" Margin="4" StrokeThickness="2"/>
                        <controls:EquationLabel BaseText="θ" SubscriptText="i" Value="{Binding Ti, Converter={StaticResource NumberConverter}, ConverterParameter=1}" ValueUnit="°C" VerticalAlignment="Center" Height="28" Margin="4,0,4,0"/>
                        <Line Y2="32" Stroke="LightGray" Margin="4" StrokeThickness="2"/>
                        <controls:EquationLabel BaseText="R" SubscriptText="si" Value="{Binding Rsi, Converter={StaticResource NumberConverter}}" ValueUnit="m²K/W" VerticalAlignment="Center" Height="28" Margin="4,0,4,0"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,8,0">
                        <controls:EquationLabel BaseText="R" SubscriptText="se" Value="{Binding Rse, Converter={StaticResource NumberConverter}}" ValueUnit="m²K/W" VerticalAlignment="Center" Height="28" Margin="4,0,4,0"/>
                        <Line Y2="32" Stroke="LightGray" Margin="4" StrokeThickness="2"/>
                        <controls:EquationLabel BaseText="θ" SubscriptText="e" Value="{Binding Te, Converter={StaticResource NumberConverter}, ConverterParameter=1}" ValueUnit="°C" VerticalAlignment="Center" Height="28" Margin="4,0,4,0"/>
                        <Line Y2="32" Stroke="LightGray" Margin="4" StrokeThickness="2"/>
                        <Label Content="Außen" FontWeight="Bold"/>
                    </StackPanel>
                </Grid>
            </Border>
            <Label Grid.Row="1" Visibility="{Binding NoLayersVisibility}" Content="Keine Ergebnisse verfügbar" Foreground="Gray" FontStyle="Italic" VerticalAlignment="Center" HorizontalAlignment="Center"/>
            <Border Grid.Row="1" Visibility="{Binding ResultsChartVisibility}" BorderBrush="{StaticResource PrimaryBorderBrush}" Background="White" BorderThickness="1" SnapsToDevicePixels="True" ClipToBounds="True" Margin="0,4,0,0" CornerRadius="8">
                <lvc:CartesianChart
                    ClipToBounds="True"
                    Series="{Binding DataPoints}"
                    Sections="{Binding LayerSections}"
                    XAxes="{Binding XAxes}"
                    YAxes="{Binding YAxes}"   
                    EasingFunction="{x:Null}"
                    TooltipPosition="Top"
                    TooltipBackgroundPaint="{Binding TooltipBackgroundPaint}"
                    TooltipTextPaint="{Binding TooltipTextPaint}"
                    TooltipTextSize="14"
                    Background="White"
                    ZoomMode="Both"
                    Margin="8,4,4,8"/>
            </Border>
        </Grid>

        <!--Grid Splitter-->
        <controls:ExpandableGridSplitter Grid.Column="1" Grid.Row="1"
                                         HorizontalAlignment="Left"
                                         VerticalAlignment="Stretch"
                                         Width="22"
                                         Background="Transparent"
                                         Margin="-11,16,0,16"/>

        <!--Bottom Right-->       
        <Grid Grid.Column="1" Grid.Row="1" Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Expander Grid.Row="0" Header="Wärme" IsExpanded="True" Margin="0,0,0,8">
                <StackPanel>
                    <controls:Gauge Title="U-Wert:"
                                    Caption="{Binding UValueGauge.Caption}"
                                    ToolTip="{Binding UValueGauge.Tooltip}"
                                    Value="{Binding UValueGauge.Value}"
                                    UnitLabel="{Binding UValueGauge.Unit}"
                                    MinValue="{Binding UValueGauge.ScaleMin}"
                                    MaxValue="{Binding UValueGauge.ScaleMax}"
                                    SymbolLabelBase="{Binding UValueGauge.SymbolBase}"
                                    SymbolLabelSubscript="{Binding UValueGauge.SymbolSubscript}"
                                    ReferenceMarkerValue="{Binding UValueGauge.MarkerValue}"
                                    MarkerSymbolLabelBase="{Binding UValueGauge.MarkerSymbolBase}"
                                    MarkerSymbolLabelSubscript="{Binding UValueGauge.MarkerSymbolSubscript}"
                                    Margin="0,0,0,8"/>
                    <controls:Gauge Title="R-Wert:"
                                    Caption="{Binding RValueGauge.Caption}"
                                    ToolTip="{Binding RValueGauge.Tooltip}"
                                    Value="{Binding RValueGauge.Value}"
                                    UnitLabel="{Binding RValueGauge.Unit}"
                                    MinValue="{Binding RValueGauge.ScaleMin}"
                                    MaxValue="{Binding RValueGauge.ScaleMax}"
                                    SymbolLabelBase="{Binding RValueGauge.SymbolBase}"
                                    SymbolLabelSubscript="{Binding RValueGauge.SymbolSubscript}"
                                    ReferenceMarkerValue="{Binding RValueGauge.MarkerValue}"
                                    MarkerSymbolLabelBase="{Binding RValueGauge.MarkerSymbolBase}"
                                    MarkerSymbolLabelSubscript="{Binding RValueGauge.MarkerSymbolSubscript}"
                                    ReverseGradient="True"
                                    Margin="0,0,0,8"/>
                    <controls:Gauge Title="Wärmestrom:"
                                    Caption="{Binding QValueCaption}"
                                    ToolTip="{Binding QValueTooltip}"
                                    Value="{Binding QValue}"
                                    UnitLabel="{Binding QValueUnitString}"
                                    MinValue="{Binding QValueScaleMin}"
                                    MaxValue="{Binding QValueScaleMax}"
                                    SymbolLabelBase="{Binding QValueSymbolBase}"/>
                    
                </StackPanel>
            </Expander>
            <Expander Grid.Row="1" Header="Feuchte" IsExpanded="True" Margin="0,0,0,8">
                <StackPanel>
                    <controls:Gauge Title="Temperaturfaktor:"
                                    Caption="{Binding FRsiCaption}"
                                    ToolTip="{Binding FRsiTooltip}"
                                    Value="{Binding FRsiValue}"
                                    UnitLabel="{Binding FRsiValueUnitString}"
                                    MinValue="{Binding FRsiValueScaleMin}"
                                    MaxValue="{Binding FRsiValueScaleMax}"
                                    SymbolLabelBase="{Binding FRsiSymbolBase}"
                                    SymbolLabelSubscript="{Binding FRsiSymbolSubscript}"
                                    MarkerSymbolLabelBase="{Binding FRsiMarkerSymbolBase}"
                                    MarkerSymbolLabelSubscript="{Binding FRsiMarkerSymbolSubscript}"
                                    ReferenceMarkerValue = "{Binding FRsiValueRefMarker}"
                                    ReverseGradient="True"
                                    Margin="0,0,0,8"/>
                    <controls:Gauge Title="Oberflächentemperatur, Innen:"
                                    Caption="{Binding TsiCaption}"
                                    Value="{Binding TsiValue}"
                                    UnitLabel="{Binding TsiValueUnitString}"
                                    MinValue="{Binding TsiValueScaleMin}"
                                    MaxValue="{Binding TsiValueScaleMax}"
                                    SymbolLabelBase="{Binding TsiSymbolBase}"
                                    SymbolLabelSubscript="{Binding TsiSymbolSubscript}"
                                    MarkerSymbolLabelBase="{Binding TsiMarkerSymbolBase}"
                                    MarkerSymbolLabelSubscript="{Binding TsiMarkerSymbolSubscript}"
                                    ReferenceMarkerValue = "{Binding TsiValueRefMarker}"
                                    ReverseGradient="True"
                                    Margin="0,0,0,8"/>
                    <controls:Gauge Title="Relative Luftfeuchte, Innen:"
                                    Caption="{Binding RelFiCaption}"
                                    Value="{Binding RelFiValue}"
                                    UnitLabel="{Binding RelFiValueUnitString}"
                                    MinValue="{Binding RelFiValueScaleMin}"
                                    MaxValue="{Binding RelFiValueScaleMax}"
                                    SymbolLabelBase="{Binding RelFiSymbolBase}"
                                    SymbolLabelSubscript="{Binding RelFiSymbolSubscript}"
                                    MarkerSymbolLabelBase="{Binding RelFiMarkerSymbolBase}"
                                    MarkerSymbolLabelSubscript="{Binding RelFiMarkerSymbolSubscript}"
                                    ReferenceMarkerValue = "{Binding RelFiValueRefMarker}"/>
                </StackPanel>
            </Expander>
        </Grid>
    </Grid>
</UserControl>
